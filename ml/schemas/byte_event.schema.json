{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "title": "MADMall Byte-Size Event",
  "type": "object",
  "required": ["event_id", "timestamp", "source", "consent", "payload"],
  "properties": {
    "event_id": { "type": "string", "minLength": 6 },
    "timestamp": { "type": "string", "minLength": 10 },
    "source": {
      "type": "object",
      "required": ["kind"],
      "properties": {
        "kind": {
          "type": "string",
          "enum": ["self", "pharmacy", "event", "mobile_unit", "mail_kit"]
        },
        "site_id": { "type": "string" },
        "region": { "type": "string" }
      },
      "additionalProperties": false
    },
    "consent": {
      "type": "object",
      "required": ["scope", "revocable"],
      "properties": {
        "scope": { "type": "string", "enum": ["care", "research"] },
        "revocable": { "type": "boolean" }
      },
      "additionalProperties": false
    },
    "payload": {
      "type": "object",
      "required": ["type"],
      "properties": {
        "type": {
          "type": "string",
          "enum": [
            "symptom_snapshot",
            "adherence_ping",
            "context_ping",
            "lab_marker"
          ]
        },
        "label": { "type": ["string", "null"] },
        "features": {
          "type": "object",
          "additionalProperties": {
            "type": ["number", "string", "boolean", "null"]
          }
        }
      },
      "additionalProperties": false
    }
  },
  "additionalProperties": false
}
